# Note: This part is already set via environment variables.
#       The commented section is for reference only.
###############################################
# Default path settings

# Settings in "pathDefaults" are applied anywhere,
# unless they are overridden in "paths".
# pathDefaults:
#   ###############################################
#   # Default path settings -> Record
#
#   # Record streams to disk.
#   record: yes
#   # Path of recording segments.
#   # Extension is added automatically.
#   # Available variables are %path (path name), %Y %m %d (year, month, day),
#   # %H %M %S (hours, minutes, seconds), %f (microseconds), %z (time zone), %s (unix epoch).
#   recordPath: ./record/%path/%Y-%m-%d_%H-%M-%S
#   # Format of recorded segments.
#   # Available formats are "fmp4" (fragmented MP4) and "mpegts" (MPEG-TS).
#   recordFormat: fmp4
#   # fMP4 segments are concatenation of small MP4 files (parts), each with this duration.
#   # MPEG-TS segments are concatenation of 188-bytes packets, flushed to disk with this period.
#   # When a system failure occurs, the last part gets lost.
#   # Therefore, the part duration is equal to the RPO (recovery point objective).
#   recordPartDuration: 1s
#   # This prevents RAM exhaustion.
#   recordMaxPartSize: 50M
#   # Minimum duration of each segment.
#   recordSegmentDuration: 2m
#   # Delete segments after this timespan.
#   # Set to 0s to disable automatic deletion.
#   recordDeleteAfter: 10m


###############################################
# Global settings -> Authentication

# Authentication method. Available values are:
# * internal: credentials are stored in the configuration file
# * http: an external HTTP URL is contacted to perform authentication
# * jwt: an external identity server provides authentication through JWTs
authMethod: internal

# Internal authentication.
# list of users.
authInternalUsers:
  # Default unprivileged user.
  # Username. 'any' means any user, including anonymous ones.
- user: any
  # IPs or networks allowed to use this user. An empty list means any IP.
  ips: []
  # List of permissions.
  permissions:
    # Available actions are: publish, read, playback, api, metrics, pprof.
  - action: publish
    # Paths can be set to further restrict access to a specific path.
    # An empty path means any path.
    # Regular expressions can be used by using a tilde as prefix.
    path:
  - action: read
    path:
  - action: playback
    path:

  # Default administrator.
  # This allows to use API, metrics and PPROF without authentication,
  # if the IP is localhost.
- user: any
  pass:
  ips: ['127.0.0.1', '::1']
  permissions:
  - action: api
  - action: metrics
  - action: pprof


###############################################
# Global settings -> RTSP server

# Enable publishing and reading streams with the RTSP protocol.
rtsp: yes
# List of enabled RTSP transport protocols.
# UDP is the most performant, but doesn't work when there's a NAT/firewall between
# server and clients.
# UDP-multicast allows to save bandwidth when clients are all in the same LAN.
# TCP is the most versatile.
# The handshake is always performed with TCP.
rtspTransports: [tcp]

###############################################
# Path settings

# Settings in "paths" are applied to specific paths, and the map key
# is the name of the path.
# Any setting in "pathDefaults" can be overridden here.
# It's possible to use regular expressions by using a tilde as prefix,
# for example "~^(test1|test2)$" will match both "test1" and "test2",
# for example "~^prefix" will match all paths that start with "prefix".
paths:
  # example:
  # my_camera:
  #   source: rtsp://my_camera

  # Settings under path "all_others" are applied to all paths that
  # do not match another entry.
  all_others:
